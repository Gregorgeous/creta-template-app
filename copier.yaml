_subdirectory: src
_templates_suffix: .jinja
_answers_file: .copier-workspace.yaml

_envops:
  block_end_string: "%}"
  block_start_string: "{%"
  comment_end_string: "#}"
  comment_start_string: "{#"
  keep_trailing_newline: true
  variable_end_string: "}}"
  variable_start_string: "{{"

_tasks:
  - '{% for api in apis %}npx npm-add-script -k copier:{{api}} -v "copier -a .copier-{{api}}.yaml update" -f; {% endfor %}'
  - '{% for api in apis %}[ ! -d "apps/{{api}}" ] && copier -a .copier-{{api}}.yaml -d api={{api}} -d organization={{organization}} copy {{api_template}} .; {% endfor %}'

author:
  type: str
  help: Author field for package.jsons
  default: Hypermedia App

email:
  type: str
  help: Email field for package.jsons
  default: no-reply@hypermedia.app

project_name:
  type: str
  help: Human-readable name
  default: Hypermedia App

app_name:
  type: str
  help: Short name (no spaces)
  default: '{{ project_name.lower().replace(" ", "-") }}'

organization:
  type: str
  help: Used as NPM package prefix
  default: "{{app_name}}"

apis:
  type: yaml
  multiline: true
  default:
    - api

repository:
  type: str
  default: https://github.com/org/repo

node_version:
  type: str
  help: Any valid node version. Used to run local env and CI
  default: 16

api_template:
  default: https://github.com/hypermedia-app/creta-api-template.git

debugger_port:
  default: "{{ range(20000,65536) | random }}"
